<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regression Analysis</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="exploratory.html">Exploratory Analysis</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Regression Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="statistical.html">Statistical Analysis</a>
    </li>
    <li>
      <a href="regression.html">Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://anmei18.shinyapps.io/interactive_map/">Interactive Map</a>
</li>
<li>
  <a href="https://github.com/lc1002/LifeExpectancy">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Regression Analysis</h1>

</div>


<p><br></p>
<p><br></p>
<div id="correlation-matrix" class="section level2">
<h2>Correlation Matrix</h2>
<pre class="r"><code>cm_df =
  le_df %&gt;%
  dplyr::select(-c(country,continent,year))

corrplot(cor(cm_df), type = &quot;upper&quot;, diag = FALSE, method = &quot;square&quot;, addCoef.col = &quot;black&quot;, number.cex = .3, tl.col = &quot;black&quot;, tl.cex = .7)</code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-3-1.png" width="80%" /></p>
<p><br></p>
<hr>
</div>
<div id="model-building" class="section level2">
<h2>Model building</h2>
<div id="model-based-on-prior-research" class="section level3">
<h3>Model Based on Prior Research</h3>
<pre class="r"><code>mod_1 = lm(le ~ status_Developed + percent_exp + HDI + adult_mort + infantdeaths + schooling + gdp + hiv_aids + gdp * percent_exp, data = le_df)
summary(mod_1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = le ~ status_Developed + percent_exp + HDI + adult_mort + 
##     infantdeaths + schooling + gdp + hiv_aids + gdp * percent_exp, 
##     data = le_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -22.496  -2.230   0.032   2.470  20.269 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       5.690e+01  3.959e-01 143.728  &lt; 2e-16 ***
## status_Developed  1.362e+00  2.535e-01   5.373 8.37e-08 ***
## percent_exp       3.396e-04  1.285e-04   2.642 0.008281 ** 
## HDI               8.323e+00  6.361e-01  13.085  &lt; 2e-16 ***
## adult_mort       -1.879e-02  8.260e-04 -22.747  &lt; 2e-16 ***
## infantdeaths     -3.857e-03  6.746e-04  -5.716 1.20e-08 ***
## schooling         8.909e-01  3.962e-02  22.486  &lt; 2e-16 ***
## gdp               5.874e-05  1.316e-05   4.464 8.34e-06 ***
## hiv_aids         -5.341e-01  1.798e-02 -29.699  &lt; 2e-16 ***
## percent_exp:gdp  -5.549e-09  1.511e-09  -3.672 0.000245 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.206 on 2928 degrees of freedom
## Multiple R-squared:  0.8053, Adjusted R-squared:  0.8047 
## F-statistic:  1345 on 9 and 2928 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>check_collinearity(mod_1)</code></pre>
<pre><code>## # Check for Multicollinearity
## 
## Low Correlation
## 
##              Term  VIF Increased SE Tolerance
##  status_Developed 1.40         1.18      0.72
##       percent_exp 1.25         1.12      0.80
##               HDI 2.92         1.71      0.34
##        adult_mort 1.93         1.39      0.52
##      infantdeaths 1.06         1.03      0.94
##         schooling 3.21         1.79      0.31
##               gdp 1.01         1.00      0.99
##          hiv_aids 1.53         1.24      0.65
##   percent_exp:gdp 1.00         1.00      1.00</code></pre>
<p><br> <br></p>
</div>
<div id="models-based-on-automated-model-selection" class="section level3">
<h3>Models Based on Automated Model Selection</h3>
<p><strong>Stepwise Regression:</strong></p>
<pre class="r"><code>step_model = stepAIC(full_model, direction = &quot;both&quot;, trace = FALSE)
summary(step_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = le ~ status_Developed + adult_mort + infantdeaths + 
##     bmi + under_five + polio_high + diphtheria_high + hiv_aids + 
##     gdp + thin_1_19 + HDI + schooling, data = le_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.209  -2.170  -0.009   2.263  16.812 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       5.711e+01  4.246e-01 134.525  &lt; 2e-16 ***
## status_Developed  1.575e+00  2.327e-01   6.768 1.58e-11 ***
## adult_mort       -1.671e-02  7.634e-04 -21.886  &lt; 2e-16 ***
## infantdeaths      9.918e-02  7.740e-03  12.815  &lt; 2e-16 ***
## bmi               3.995e-02  4.634e-03   8.621  &lt; 2e-16 ***
## under_five       -7.371e-02  5.702e-03 -12.927  &lt; 2e-16 ***
## polio_high        1.854e+00  3.026e-01   6.128 1.01e-09 ***
## diphtheria_high   1.163e+00  3.031e-01   3.838 0.000127 ***
## hiv_aids         -4.900e-01  1.661e-02 -29.506  &lt; 2e-16 ***
## gdp               5.519e-05  6.297e-06   8.764  &lt; 2e-16 ***
## thin_1_19        -7.734e-02  2.175e-02  -3.557 0.000382 ***
## HDI               6.095e+00  5.891e-01  10.348  &lt; 2e-16 ***
## schooling         6.766e-01  3.775e-02  17.925  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.854 on 2925 degrees of freedom
## Multiple R-squared:  0.8366, Adjusted R-squared:  0.836 
## F-statistic:  1248 on 12 and 2925 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>check_collinearity(step_model)</code></pre>
<pre><code>## # Check for Multicollinearity
## 
## Low Correlation
## 
##              Term  VIF Increased SE Tolerance
##  status_Developed 1.27         1.13      0.79
##        adult_mort 2.84         1.69      0.35
##               bmi 2.86         1.69      0.35
##          hiv_aids 1.92         1.38      0.52
##               gdp 1.00         1.00      1.00
##               HDI 3.35         1.83      0.30
##         schooling 4.75         2.18      0.21
## 
## Moderate Correlation
## 
##             Term  VIF Increased SE Tolerance
##       polio_high 7.26         2.69      0.14
##  diphtheria_high 6.78         2.60      0.15
## 
## High Correlation
## 
##          Term     VIF Increased SE Tolerance
##  infantdeaths 5856.27        76.53      0.00
##    under_five 5846.13        76.46      0.00
##     thin_1_19   11.75         3.43      0.09</code></pre>
<p><em>Final Stepwise Model</em></p>
<pre class="r"><code>## remove insignificant and high correlation variables (under_five, infantdeaths)
mod_2 = lm(le ~ status_Developed + adult_mort + bmi + polio_high + diphtheria_high + hiv_aids + gdp + thin_1_19 + HDI + schooling, data = le_df)</code></pre>
<p><br> <br></p>
<p><strong>Forward/Backward Selection:</strong></p>
<p><em>Backward Elimination</em></p>
<pre class="r"><code>back_mod = stepAIC(full_model, direction = &quot;backward&quot;, 
                      trace = FALSE, scope = formula(full_model))
summary(back_mod)</code></pre>
<pre><code>## 
## Call:
## lm(formula = le ~ status_Developed + adult_mort + infantdeaths + 
##     bmi + under_five + polio_high + diphtheria_high + hiv_aids + 
##     gdp + thin_1_19 + HDI + schooling, data = le_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.209  -2.170  -0.009   2.263  16.812 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       5.711e+01  4.246e-01 134.525  &lt; 2e-16 ***
## status_Developed  1.575e+00  2.327e-01   6.768 1.58e-11 ***
## adult_mort       -1.671e-02  7.634e-04 -21.886  &lt; 2e-16 ***
## infantdeaths      9.918e-02  7.740e-03  12.815  &lt; 2e-16 ***
## bmi               3.995e-02  4.634e-03   8.621  &lt; 2e-16 ***
## under_five       -7.371e-02  5.702e-03 -12.927  &lt; 2e-16 ***
## polio_high        1.854e+00  3.026e-01   6.128 1.01e-09 ***
## diphtheria_high   1.163e+00  3.031e-01   3.838 0.000127 ***
## hiv_aids         -4.900e-01  1.661e-02 -29.506  &lt; 2e-16 ***
## gdp               5.519e-05  6.297e-06   8.764  &lt; 2e-16 ***
## thin_1_19        -7.734e-02  2.175e-02  -3.557 0.000382 ***
## HDI               6.095e+00  5.891e-01  10.348  &lt; 2e-16 ***
## schooling         6.766e-01  3.775e-02  17.925  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.854 on 2925 degrees of freedom
## Multiple R-squared:  0.8366, Adjusted R-squared:  0.836 
## F-statistic:  1248 on 12 and 2925 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>check_collinearity(back_mod)</code></pre>
<pre><code>## # Check for Multicollinearity
## 
## Low Correlation
## 
##              Term  VIF Increased SE Tolerance
##  status_Developed 1.27         1.13      0.79
##        adult_mort 2.84         1.69      0.35
##               bmi 2.86         1.69      0.35
##          hiv_aids 1.92         1.38      0.52
##               gdp 1.00         1.00      1.00
##               HDI 3.35         1.83      0.30
##         schooling 4.75         2.18      0.21
## 
## Moderate Correlation
## 
##             Term  VIF Increased SE Tolerance
##       polio_high 7.26         2.69      0.14
##  diphtheria_high 6.78         2.60      0.15
## 
## High Correlation
## 
##          Term     VIF Increased SE Tolerance
##  infantdeaths 5856.27        76.53      0.00
##    under_five 5846.13        76.46      0.00
##     thin_1_19   11.75         3.43      0.09</code></pre>
<pre class="r"><code>backward = lm(le ~ status_Developed + adult_mort + bmi + polio_high + diphtheria_high + hiv_aids + gdp + thin_1_19 + HDI + schooling, data = le_df)</code></pre>
<p><em>Forward Selection</em></p>
<pre class="r"><code>forward_mod = stepAIC(full_model, direction = &quot;forward&quot;, trace = FALSE, scope = formula(full_model))
summary(forward_mod)</code></pre>
<pre><code>## 
## Call:
## lm(formula = le ~ status_Developed + adult_mort + infantdeaths + 
##     alcohol + percent_exp + hepatitis_b_high + measles + bmi + 
##     under_five + polio_high + total_exp + diphtheria_high + hiv_aids + 
##     gdp + population + thin_1_19 + thin_5_9 + HDI + schooling, 
##     data = le_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -20.4808  -2.1461   0.0048   2.2608  16.7409 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       5.694e+01  4.621e-01 123.215  &lt; 2e-16 ***
## status_Developed  1.435e+00  2.584e-01   5.552 3.08e-08 ***
## adult_mort       -1.674e-02  7.716e-04 -21.689  &lt; 2e-16 ***
## infantdeaths      1.004e-01  7.970e-03  12.592  &lt; 2e-16 ***
## alcohol           1.426e-02  2.427e-02   0.587   0.5569    
## percent_exp       4.938e-05  7.963e-05   0.620   0.5352    
## hepatitis_b_high  7.132e-02  2.430e-01   0.293   0.7692    
## measles           5.274e-07  7.313e-06   0.072   0.9425    
## bmi               3.930e-02  4.713e-03   8.338  &lt; 2e-16 ***
## under_five       -7.455e-02  5.845e-03 -12.755  &lt; 2e-16 ***
## polio_high        1.836e+00  3.070e-01   5.980 2.50e-09 ***
## total_exp         3.557e-02  3.110e-02   1.144   0.2528    
## diphtheria_high   1.105e+00  3.409e-01   3.243   0.0012 ** 
## hiv_aids         -4.921e-01  1.674e-02 -29.386  &lt; 2e-16 ***
## gdp               4.912e-05  1.221e-05   4.022 5.91e-05 ***
## population       -2.774e-10  1.582e-09  -0.175   0.8608    
## thin_1_19        -5.000e-02  4.624e-02  -1.081   0.2796    
## thin_5_9         -2.412e-02  4.565e-02  -0.528   0.5973    
## HDI               6.186e+00  5.936e-01  10.421  &lt; 2e-16 ***
## schooling         6.682e-01  3.875e-02  17.243  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.857 on 2918 degrees of freedom
## Multiple R-squared:  0.8368, Adjusted R-squared:  0.8357 
## F-statistic: 787.5 on 19 and 2918 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>check_collinearity(forward_mod)</code></pre>
<pre><code>## # Check for Multicollinearity
## 
## Low Correlation
## 
##              Term  VIF Increased SE Tolerance
##  status_Developed 1.63         1.28      0.61
##        adult_mort 2.07         1.44      0.48
##           alcohol 2.23         1.49      0.45
##       percent_exp 1.11         1.05      0.90
##           measles 1.00         1.00      1.00
##               bmi 3.49         1.87      0.29
##         total_exp 1.48         1.22      0.68
##          hiv_aids 1.66         1.29      0.60
##               gdp 1.01         1.00      0.99
##        population 1.00         1.00      1.00
##               HDI 3.85         1.96      0.26
## 
## Moderate Correlation
## 
##              Term  VIF Increased SE Tolerance
##  hepatitis_b_high 5.87         2.42      0.17
##        polio_high 9.39         3.06      0.11
##         schooling 6.15         2.48      0.16
## 
## High Correlation
## 
##             Term     VIF Increased SE Tolerance
##     infantdeaths 5978.58        77.32      0.00
##       under_five 5987.53        77.38      0.00
##  diphtheria_high   10.30         3.21      0.10
##        thin_1_19   60.00         7.75      0.02
##         thin_5_9   64.04         8.00      0.02</code></pre>
<pre class="r"><code>forward = lm(le ~ status_Developed + adult_mort + infantdeaths + bmi + polio_high + diphtheria_low + hiv_aids + gdp + HDI + schooling, data = le_df)</code></pre>
<p><br> <br></p>
<p><strong>Best Subsets Regression:</strong></p>
<p><br></p>
<p><em>Best Fitting Models Based on the Numbers of Predictors</em></p>
<pre class="r"><code>table %&gt;% 
     knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">status_Developed</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">adult_mort</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
<tr class="odd">
<td align="left">infantdeaths</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">*</td>
</tr>
<tr class="even">
<td align="left">alcohol</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">percent_exp</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">hepatitis_b_high</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">measles</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">bmi</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">under_five</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">*</td>
</tr>
<tr class="even">
<td align="left">polio_high</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
<tr class="odd">
<td align="left">total_exp</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">diphtheria_high</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">hiv_aids</td>
<td align="left"></td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
<tr class="even">
<td align="left">gdp</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
<tr class="odd">
<td align="left">population</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">thin_1_19</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">thin_5_9</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">HDI</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
<tr class="odd">
<td align="left">schooling</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><em>Comparison Based on Model Selection Criteria</em></p>
<pre class="r"><code>Model_comparison =
  tibble(
    n_pred = c(1:8),
    &quot;Adjusted R2&quot; = best_summary$adjr2,
    &quot;Adj R2&quot; = best_summary$adjr2,
    &quot;BIC&quot; = best_summary$bic,
    &quot;Cp&quot; = best_summary$cp,
    &quot;RSE&quot; = best_summary$rsq,
    &quot;RSS&quot; = best_summary$rss
    ) %&gt;%
    gather(key = &quot;Statistics&quot;, value = &quot;value&quot;, 2:6) %&gt;%
    ggplot(aes(x = n_pred, y = value)) +
      geom_point() +
      geom_line() +
      facet_grid(Statistics ~ ., scales = &quot;free_y&quot;) +
      labs(
        x = &quot;Number of Predictors&quot;,
        y = &quot;Values&quot;,
        title = &quot;Model Selection Criteria Comparison&quot;
      )

Model_comparison</code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-13-1.png" width="80%" /></p>
<p><em>Final Best Subsets Model</em></p>
<pre class="r"><code>mod_3 = lm(le ~ adult_mort + under_five + polio_high + hiv_aids + gdp + HDI + schooling, data = le_df)</code></pre>
<p><br> <br></p>
<p><strong>Lasso Regression:</strong></p>
<pre class="r"><code>#define response variable
y = le_df$le

#define matrix of predictor variables
x = data.matrix(le_df[, c(&#39;status_Developed&#39;, &#39;adult_mort&#39;, &#39;infantdeaths&#39;, &#39;alcohol&#39;, &#39;percent_exp&#39;, &#39;hepatitis_b_high&#39;, &#39;measles&#39;, &#39;bmi&#39;, &#39;under_five&#39;, &#39;polio_high&#39;, &#39;total_exp&#39;, &#39;diphtheria_high&#39;, &#39;hiv_aids&#39;, &#39;gdp&#39;, &#39;population&#39;, &#39;thin_1_19&#39;, &#39;thin_5_9&#39;, &#39;HDI&#39;, &#39;schooling&#39;)])

#perform k-fold cross-validation to find optimal lambda value
cv_lasso_model &lt;- cv.glmnet(x, y, alpha = 1)

#find optimal lambda value that minimizes test MSE
best_lasso_lambda &lt;- cv_lasso_model$lambda.min
best_lasso_lambda</code></pre>
<pre><code>## [1] 0.001657543</code></pre>
<pre class="r"><code>mod_4 = glmnet(x, y, alpha = 1, lambda = best_lasso_lambda)
coef(mod_4)</code></pre>
<pre><code>## 20 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                             s0
## (Intercept)       5.686219e+01
## status_Developed  1.432139e+00
## adult_mort       -1.676946e-02
## infantdeaths      9.115129e-02
## alcohol           1.073753e-02
## percent_exp       5.065888e-05
## hepatitis_b_high  5.635705e-02
## measles           .           
## bmi               3.949487e-02
## under_five       -6.781075e-02
## polio_high        1.851516e+00
## total_exp         3.530760e-02
## diphtheria_high   1.131401e+00
## hiv_aids         -4.930447e-01
## gdp               4.855340e-05
## population        .           
## thin_1_19        -5.095772e-02
## thin_5_9         -2.119315e-02
## HDI               6.248119e+00
## schooling         6.699518e-01</code></pre>
<pre class="r"><code>#No coefficient is shown for the predictor measles and population because the lasso regression shrunk the coefficients all the way to zero. This means it was completely dropped from the model because it wasn’t influential enough.

plot(cv_lasso_model)</code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-15-1.png" width="80%" /></p>
<p><br> <br></p>
<p><strong>Ridge Regression:</strong></p>
<pre class="r"><code>#define response variable
y = le_df$le

#define matrix of predictor variables
x = data.matrix(le_df[, c(&#39;status_Developed&#39;, &#39;adult_mort&#39;, &#39;infantdeaths&#39;, &#39;alcohol&#39;, &#39;percent_exp&#39;, &#39;hepatitis_b_high&#39;, &#39;measles&#39;, &#39;bmi&#39;, &#39;under_five&#39;, &#39;polio_high&#39;, &#39;total_exp&#39;, &#39;diphtheria_high&#39;, &#39;hiv_aids&#39;, &#39;gdp&#39;, &#39;population&#39;, &#39;thin_1_19&#39;, &#39;thin_5_9&#39;, &#39;HDI&#39;, &#39;schooling&#39;)])

#fit ridge regression model
ridge_model = glmnet(x, y, alpha = 0)

#view summary of model
summary(ridge_model)</code></pre>
<pre><code>##           Length Class     Mode   
## a0         100   -none-    numeric
## beta      1900   dgCMatrix S4     
## df         100   -none-    numeric
## dim          2   -none-    numeric
## lambda     100   -none-    numeric
## dev.ratio  100   -none-    numeric
## nulldev      1   -none-    numeric
## npasses      1   -none-    numeric
## jerr         1   -none-    numeric
## offset       1   -none-    logical
## call         4   -none-    call   
## nobs         1   -none-    numeric</code></pre>
<pre class="r"><code>dim(coef(ridge_model))</code></pre>
<pre><code>## [1]  20 100</code></pre>
<pre class="r"><code>plot(ridge_model) </code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-16-1.png" width="80%" /></p>
<pre class="r"><code>ridge_model$lambda[50] </code></pre>
<pre><code>## [1] 75.16754</code></pre>
<pre class="r"><code>coef(ridge_model)[,50] </code></pre>
<pre><code>##      (Intercept) status_Developed       adult_mort     infantdeaths 
##     6.427186e+01     8.281424e-01    -4.440359e-03    -7.194046e-04 
##          alcohol      percent_exp hepatitis_b_high          measles 
##     5.892167e-02     1.209778e-04     5.944268e-01    -7.374990e-06 
##              bmi       under_five       polio_high        total_exp 
##     1.948964e-02    -6.777361e-04     8.273064e-01     4.589668e-02 
##  diphtheria_high         hiv_aids              gdp       population 
##     8.013775e-01    -9.366789e-02     2.207736e-05     2.529772e-10 
##        thin_1_19         thin_5_9              HDI        schooling 
##    -6.447260e-02    -6.172822e-02     2.407839e+00     1.506645e-01</code></pre>
<pre class="r"><code>sqrt(sum(coef(ridge_model)[-1,50]^2)) # Calculate l2 norm</code></pre>
<pre><code>## [1] 2.86512</code></pre>
<pre class="r"><code>predict(ridge_model, s = 50, type = &quot;coefficients&quot;)[1:20,]</code></pre>
<pre><code>##      (Intercept) status_Developed       adult_mort     infantdeaths 
##     6.309527e+01     1.005805e+00    -5.790199e-03    -7.253525e-04 
##          alcohol      percent_exp hepatitis_b_high          measles 
##     6.837156e-02     1.445259e-04     7.131771e-01    -8.409870e-06 
##              bmi       under_five       polio_high        total_exp 
##     2.418424e-02    -7.392279e-04     1.016872e+00     5.174473e-02 
##  diphtheria_high         hiv_aids              gdp       population 
##     9.784058e-01    -1.251434e-01     2.682465e-05     5.708482e-10 
##        thin_1_19         thin_5_9              HDI        schooling 
##    -7.570922e-02    -7.215599e-02     3.050262e+00     1.908097e-01</code></pre>
<p><em>Identify lambda value</em></p>
<pre class="r"><code>#perform k-fold cross-validation to find optimal lambda value
cv_model = cv.glmnet(x, y, alpha = 0)

#find optimal lambda value that minimizes test MSE
best_lambda = cv_model$lambda.min
best_lambda</code></pre>
<pre><code>## [1] 0.7175106</code></pre>
<pre class="r"><code>#produce plot of test MSE by lambda value
plot(cv_model) </code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-17-1.png" width="80%" /></p>
<br> <br>
<hr>
</div>
</div>
<div id="cross-validation" class="section level2">
<h2>Cross Validation</h2>
<div id="cross-validating-with-violin-plots" class="section level3">
<h3>Cross-validating with Violin Plots</h3>
<pre class="r"><code>rmse_plot =
  rmse_table %&gt;% 
  ggplot(aes(x = model, y = rmse, fill = model)) + 
  geom_violin() + 
  labs(x = &quot;&quot;,
       y = &quot;RMSE&quot;) +
  scale_fill_brewer(type = &#39;seq&#39;, palette = &#39;Set2&#39;) +
  theme(legend.position = &#39;none&#39;,
        plot.title = element_text(hjust = 0.5))

rsq_plot =
  rsq_table %&gt;% 
  ggplot(aes(x = model, y = rsq, fill = model)) + 
  geom_violin() + 
  labs(x = &quot;&quot;,
       y = &quot;RSquared&quot;) +
  scale_fill_brewer(type = &#39;seq&#39;, palette = &#39;Set2&#39;) +
  theme(legend.position = &#39;none&#39;,
        plot.title = element_text(hjust = 0.5))

mae_plot =
  mae_table %&gt;% 
  ggplot(aes(x = model, y = mae, fill = model)) + 
  geom_violin() + 
  labs(x = &quot;&quot;,
       y = &quot;MAE&quot;) +
  scale_fill_brewer(type = &#39;seq&#39;, palette = &#39;Set2&#39;) +
  theme(legend.position = &#39;none&#39;,
        plot.title = element_text(hjust = 0.5))

rmse_plot/rsq_plot/mae_plot</code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-20-1.png" width="80%" /></p>
<p><br> <br></p>
</div>
<div id="cross-validation-table" class="section level3">
<h3>Cross Validation Table</h3>
<pre class="r"><code>mean_rmse =
  rmse_table %&gt;% 
  group_by(model) %&gt;% 
  summarize(mean_rmse = mean(rmse))

mean_mae = 
  mae_table %&gt;%
  group_by(model) %&gt;% 
  summarize(mean_mae = mean(mae))

mean_rsquare = 
  rsq_table %&gt;% 
  group_by(model) %&gt;% 
  summarize(mean_rsq = mean(rsq))

Model_comparison_table =
  full_join(inner_join(mean_rmse, mean_rsquare), mean_mae) %&gt;% 
  knitr::kable()

Model_comparison_table </code></pre>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">mean_rmse</th>
<th align="right">mean_rsq</th>
<th align="right">mean_mae</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Model 1</td>
<td align="right">4.209394</td>
<td align="right">0.8053251</td>
<td align="right">3.091406</td>
</tr>
<tr class="even">
<td align="left">Model 2</td>
<td align="right">3.970951</td>
<td align="right">0.8267516</td>
<td align="right">2.964913</td>
</tr>
<tr class="odd">
<td align="left">Model 3</td>
<td align="right">4.073934</td>
<td align="right">0.8176339</td>
<td align="right">3.012049</td>
</tr>
<tr class="even">
<td align="left">Model 4</td>
<td align="right">3.830895</td>
<td align="right">0.8386278</td>
<td align="right">2.868733</td>
</tr>
<tr class="odd">
<td align="left">Model 5</td>
<td align="right">3.830895</td>
<td align="right">0.8386278</td>
<td align="right">2.868733</td>
</tr>
</tbody>
</table>
<br>
<hr>
</div>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<pre class="r"><code>mod_1 %&gt;% 
  broom::tidy() %&gt;% 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">56.8966265</td>
<td align="right">0.3958633</td>
<td align="right">143.727982</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">status_Developed</td>
<td align="right">1.3617600</td>
<td align="right">0.2534639</td>
<td align="right">5.372598</td>
<td align="right">0.0000001</td>
</tr>
<tr class="odd">
<td align="left">percent_exp</td>
<td align="right">0.0003396</td>
<td align="right">0.0001285</td>
<td align="right">2.642179</td>
<td align="right">0.0082813</td>
</tr>
<tr class="even">
<td align="left">HDI</td>
<td align="right">8.3230014</td>
<td align="right">0.6360650</td>
<td align="right">13.085142</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">adult_mort</td>
<td align="right">-0.0187897</td>
<td align="right">0.0008260</td>
<td align="right">-22.746898</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">infantdeaths</td>
<td align="right">-0.0038565</td>
<td align="right">0.0006746</td>
<td align="right">-5.716483</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">schooling</td>
<td align="right">0.8909016</td>
<td align="right">0.0396209</td>
<td align="right">22.485621</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp</td>
<td align="right">0.0000587</td>
<td align="right">0.0000132</td>
<td align="right">4.464205</td>
<td align="right">0.0000083</td>
</tr>
<tr class="odd">
<td align="left">hiv_aids</td>
<td align="right">-0.5340504</td>
<td align="right">0.0179823</td>
<td align="right">-29.698666</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">percent_exp:gdp</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">-3.672232</td>
<td align="right">0.0002447</td>
</tr>
</tbody>
</table>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
